class t{constructor(t,e,s,a,n,i,r=null,o=null){this.id=t,this.parentId=e,this.name=s,this.progress=a>100?100:a<0?0:a,this.datePlannedStart=n,this.datePlannedEnd=i,this.dateActualStart=r,this.dateActualEnd=o}}class e{constructor(t,e,s,a,n,i=null,r=null,o=0,h=null){this.durationPlanned=0,this.durationActual=0,this._progress=0,this.externalId=t,this.name=e,this.progress=s,this.datePlannedStart=a,this.datePlannedEnd=n,this.dateActualStart=i,this.dateActualEnd=r,this.nestingLvl=o,this.parentUuid=h,this.refreshDuration(),this.uuid=crypto.getRandomValues(new Uint32Array(4)).join("-")}set progress(t){this._progress=t<0?0:t>100?100:t}get progress(){return this._progress}static initTasksFromModels(t){const s=t.slice(),a=[];let n=[];for(let t=s.length-1;t>=0;t--){const i=s[t];if(null===i.parentId){const r=new e(i.id,i.name,i.progress,i.datePlannedStart,i.datePlannedEnd,i.dateActualStart,i.dateActualEnd);a.push(r),n.push(r),s.splice(t,1)}}let i=1;for(;0!==s.length||0!==n.length;){const t=[];n.forEach(n=>{for(let r=s.length-1;r>=0;r--){const o=s[r];if(o.parentId===n.externalId){const h=new e(o.id,o.name,o.progress,o.datePlannedStart,o.datePlannedEnd,o.dateActualStart,o.dateActualEnd,i,n.uuid);a.push(h),t.push(h),s.splice(r,1)}}}),n=t,i++}return a}refreshDuration(){this.durationPlanned=this.datePlannedEnd.getTime()-this.datePlannedStart.getTime(),this.dateActualStart&&this.dateActualEnd?this.durationActual=this.dateActualEnd.getTime()-this.dateActualStart.getTime():this.durationActual=0}}class s{constructor(t=null){this.headerHeight=60,this.rowHeight=0,this.columnWidth=0,this.scale="day",this.locale="en",this.customDateFormat="YYYY-MM-DD",this.allowMoveBars=!0,this.allowResizeBars=!0,this.allowMoveProgress=!0,this.barHeaderGetter=t=>t.name,this.tooltipHeaderGetter=t=>t.name,this.tooltipPlannedPeriodGetter=t=>`${t.datePlannedStart}-${t.datePlannedEnd}`,this.tooltipActualPeriodGetter=t=>`${t.dateActualStart}-${t.dateActualEnd}`,this.tooltipPlannedDurationGetter=t=>t.durationPlanned,this.tooltipActualDurationGetter=t=>t.durationActual,this.tooltipProgressGetter=t=>t.progress,null!=t&&Object.assign(this,t)}}class a{constructor(t){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.classList.add(...t),this._htmlSvg=e}get htmlSvg(){return this._htmlSvg}}class n{constructor(t,e){const s=document.createElement("table");s.classList.add(...t),this._htmlTable=s,this._minWidth=e}get htmlTable(){return this._htmlTable}setWidth(t){this._htmlTable.style.width=Math.max(this._minWidth,t)+"px",this._htmlTable.style.flexGrow="0"}}class i{constructor(t,e){if(this._tasks=[],this._htmlSeparatorDragActive=!1,this.onMouseDownOnSep=t=>{t.target===this._htmlSeparator&&(this._htmlSeparatorDragActive=!0)},this.onMouseMoveOnSep=t=>{if(!this._htmlSeparatorDragActive)return!1;const e=this._htmlWrapper.offsetLeft,s=t.clientX-e;this._table.setWidth(s)},this.onMouseUpOnSep=t=>{this._htmlSeparatorDragActive=!1},this._htmlContainer=document.querySelector(t),!this._htmlContainer)throw new Error("Container is null");this.createLayout(),this._options=new s(e)}set tasks(t){this.clearTasks(),this.pushTasks(t)}destroy(){document.removeEventListener("mousedown",this.onMouseDownOnSep),document.removeEventListener("mousemove",this.onMouseMoveOnSep),document.removeEventListener("mouseup",this.onMouseUpOnSep)}createLayout(){const t=document.createElement("div");t.classList.add(i.WRAPPER_CLASS);const e=document.createElement("div");e.classList.add(i.SEPARATOR_CLASS),this._table=new n([i.TABLE_CLASS],i.TABLE_MIN_WIDTH),this._chart=new a([i.CHART_CLASS]),t.appendChild(this._table.htmlTable),t.appendChild(e),t.appendChild(this._chart.htmlSvg),this._htmlContainer.appendChild(t),this._htmlWrapper=t,this._htmlSeparator=e,document.addEventListener("mousedown",this.onMouseDownOnSep),document.addEventListener("mousemove",this.onMouseMoveOnSep),document.addEventListener("mouseup",this.onMouseUpOnSep)}clearTasks(){this._tasks.length=0}pushTasks(t){const s=e.initTasksFromModels(t);this._tasks.push(...s)}}i.WRAPPER_CLASS="ts-gantt-wrapper",i.TABLE_CLASS="ts-gantt-grid",i.CHART_CLASS="ts-gantt-chart",i.SEPARATOR_CLASS="ts-gantt-separator",i.TABLE_MIN_WIDTH=100;export{i as TsGantt,s as TsGanttOptions,e as TsGanttTask,t as TsGanttTaskModel};
